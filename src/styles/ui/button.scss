@use 'sass:map';
@use 'sass:list';

// ============================================================================
// BUTTON SYSTEM - SETTINGS
// ============================================================================

// Color variants for button system
$button-colors: (
  primary,
  secondary,
  accent,
  text,
  textSecondary,
  error,
  success,
  warning
);

// Button style variants
$button-variants: (solid, outline, ghost);

// Button size configurations
$button-sizes: (
  pequeno: (
    padding: (
      12px,
      6px
    )
  ),
  medio: (
    padding: (
      16px,
      8px
    )
  ),
  grande: (
    padding: (
      24px,
      12px
    )
  )
);

// ============================================================================
// BUTTON SYSTEM - TOOLS
// ============================================================================

/**
 * Button transition effect mixin with hover transform
 */
@mixin button-transition {
  @apply transform transition-all duration-200 ease-in-out;

  &:hover:not(:disabled) {
    transform: scale(1.05);
  }
}

/**
 * Focus ring mixin for accessibility compliance
 * @param {string} $color - Color variant for focus ring
 */
@mixin button-focus($color) {
  &:focus-visible {
    @apply outline-none;
    box-shadow:
      0 0 0 2px rgb(var(--color-background)),
      0 0 0 4px rgb(var(--color-#{$color}) / 0.5);
  }
}

/**
 * Main button variant generator mixin
 * @param {string} $variant - Button style variant (solid, outline, ghost)
 * @param {string} $color - Color theme for the button
 */
@mixin button-variant($variant, $color) {
  @include button-focus($color);
  @apply border-2;

  @if $variant == solid {
    @if $color == text {
      background-color: rgb(var(--color-text));
      color: rgb(var(--color-textSecondary));
      @apply border-transparent;

      &:hover:not(:disabled) {
        @apply bg-transparent;
        color: rgb(var(--color-text));
        border-color: rgb(var(--color-text));
      }
    } @else if $color == textSecondary {
      background-color: rgb(var(--color-textSecondary));
      color: rgb(var(--color-text));
      border-color: rgb(var(--color-text));

      &:hover:not(:disabled) {
        background-color: rgb(var(--color-text));
        color: rgb(var(--color-textSecondary));
        border-color: rgb(var(--color-text));
      }
    } @else {
      background-color: rgb(var(--color-#{$color}));
      color: rgb(var(--color-text));
      @apply border-transparent;

      &:hover:not(:disabled) {
        @apply bg-transparent;
        color: rgb(var(--color-#{$color}));
        border-color: rgb(var(--color-#{$color}));
      }
    }
  } @else if $variant == outline {
    @apply bg-transparent;
    color: rgb(var(--color-#{$color}));
    border-color: rgb(var(--color-#{$color}));

    &:hover:not(:disabled) {
      background-color: rgb(var(--color-#{$color}));
      color: rgb(var(--color-text));
    }
  } @else if $variant == ghost {
    @apply bg-transparent border-transparent;
    color: rgb(var(--color-#{$color}));

    &:hover:not(:disabled) {
      background-color: rgb(var(--color-#{$color}) / 0.1);
    }
  }
}

/**
 * Button size variant generator mixin
 * @param {string} $size - Size variant (pequeno, medio, grande)
 */
@mixin button-size($size) {
  $config: map.get($button-sizes, $size);
  $padding: map.get($config, padding);
  $icon-size: map.get($config, icon-size);

  padding: list.nth($padding, 2) list.nth($padding, 1);

  @if $size == pequeno {
    @apply text-xs;

    // Responsive typography
    @screen sm {
      @apply text-sm;
    }

    // Icon sizing
    &.btn--with-icon .btn__icon {
      @apply w-3 h-3;
    }
  } @else if $size == medio {
    @apply text-sm;

    // Responsive typography
    @screen sm {
      @apply text-base;
    }

    // Icon sizing
    &.btn--with-icon .btn__icon {
      @apply w-4 h-4;
    }
  } @else if $size == grande {
    @apply text-base;

    // Responsive typography
    @screen sm {
      @apply text-lg;
    }

    // Icon sizing
    &.btn--with-icon .btn__icon {
      @apply w-5 h-5;
    }
  }
}

// ============================================================================
// BUTTON SYSTEM - BASE COMPONENT
// ============================================================================

.btn {
  @include button-transition;
  @apply rounded-md font-medium cursor-pointer inline-flex items-center justify-center;

  // Disabled state styling
  &:disabled {
    @apply opacity-50 cursor-not-allowed;
    transform: none;
  }

  // Icon layout support
  &--with-icon {
    @apply gap-2;

    .btn__icon {
      @apply flex-shrink-0;
    }
  }

  // Loading state with overlay effect
  &--loading {
    @apply relative;

    &::after {
      content: '';
      @apply absolute inset-0 rounded-md;
      background: rgba(255, 255, 255, 0.1);
      animation: btn-pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }
  }
}

// ============================================================================
// BUTTON SYSTEM - SIZE VARIANTS
// ============================================================================

@each $size, $config in $button-sizes {
  .btn--#{$size} {
    @include button-size($size);
  }
}

// ============================================================================
// BUTTON SYSTEM - COLOR & VARIANT COMBINATIONS
// ============================================================================

// Generate all color and variant combinations
@each $color in $button-colors {
  @each $variant in $button-variants {
    .btn--#{$variant}-#{$color} {
      @include button-variant($variant, $color);
    }
  }
}

// ============================================================================
// BUTTON SYSTEM - LAYOUT COMPONENTS
// ============================================================================

/**
 * Button container for alignment control
 */
.btn-container {
  @apply flex;

  &--start {
    @apply justify-start;
  }

  &--center {
    @apply justify-center;
  }

  &--end {
    @apply justify-end;
  }
}

/**
 * Button group for connected button layouts
 */
.btn-group {
  @apply flex;

  .btn {
    @apply rounded-none;

    &:not(:first-child) {
      border-left: none;
    }

    &:first-child {
      @apply rounded-l-md;
    }

    &:last-child {
      @apply rounded-r-md;
    }

    &:only-child {
      @apply rounded-md;
    }
  }
}

// ============================================================================
// BUTTON SYSTEM - UTILITY COMPONENTS
// ============================================================================

/**
 * Loading spinner component for button loading state
 */
.btn__spinner {
  @apply animate-spin border-2 border-current border-t-transparent rounded-full w-4 h-4;
}

// ============================================================================
// BUTTON SYSTEM - ANIMATIONS
// ============================================================================

/**
 * Pulse animation for button loading state overlay
 */
@keyframes btn-pulse {
  0%,
  100% {
    opacity: 0.8;
  }
  50% {
    opacity: 0.5;
  }
}
